#[[
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0.  If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
#
# Copyright 1997 - July 2008 CWI, August 2008 - 2019 MonetDB B.V.
#]]

include_directories(${ODBC_INCLUDE_DIR})

add_library(MonetODBC_headers INTERFACE)
target_include_directories(MonetODBC_headers INTERFACE $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
		$<INSTALL_INTERFACE:${INCLUDEDIR}/monetdb>)

add_library(MonetODBC MODULE
			ODBCConvert.c
			ODBCDbc.c
			ODBCDbc.h
			ODBCDesc.c
			ODBCDesc.h
			ODBCEnv.c
			ODBCEnv.h
			ODBCError.c
			ODBCError.h
			ODBCGlobal.h
			ODBCQueries.h
			ODBCStmt.c
			ODBCStmt.h
			ODBCUtil.c
			ODBCUtil.h
			SQLAllocConnect.c
			SQLAllocEnv.c
			SQLAllocHandle.c
			SQLAllocStmt.c
			SQLBindCol.c
			SQLBindParameter.c
			SQLBrowseConnect.c
			SQLBulkOperations.c
			SQLCancel.c
			SQLCloseCursor.c
			SQLColAttribute.c
			SQLColAttributes.c
			SQLColumnPrivileges.c
			SQLColumns.c
			SQLConnect.c
			SQLCopyDesc.c
			SQLDataSources.c
			SQLDescribeCol.c
			SQLDescribeParam.c
			SQLDisconnect.c
			SQLDriverConnect.c
			SQLDrivers.c
			SQLEndTran.c
			SQLError.c
			SQLExecDirect.c
			SQLExecute.c
			SQLExtendedFetch.c
			SQLFetch.c
			SQLFetchScroll.c
			SQLForeignKeys.c
			SQLFreeConnect.c
			SQLFreeEnv.c
			SQLFreeHandle.c
			SQLFreeStmt.c
			SQLGetConnectAttr.c
			SQLGetConnectOption.c
			SQLGetCursorName.c
			SQLGetData.c
			SQLGetDescField.c
			SQLGetDescRec.c
			SQLGetDiagField.c
			SQLGetDiagRec.c
			SQLGetEnvAttr.c
			SQLGetFunctions.c
			SQLGetInfo.c
			SQLGetStmtAttr.c
			SQLGetStmtOption.c
			SQLGetTypeInfo.c
			SQLMoreResults.c
			SQLNativeSql.c
			SQLNumParams.c
			SQLNumResultCols.c
			SQLParamData.c
			SQLParamOptions.c
			SQLPrepare.c
			SQLPrimaryKeys.c
			SQLProcedureColumns.c
			SQLProcedures.c
			SQLPutData.c
			SQLRowCount.c
			SQLSetConnectAttr.c
			SQLSetConnectOption.c
			SQLSetCursorName.c
			SQLSetDescField.c
			SQLSetDescRec.c
			SQLSetEnvAttr.c
			SQLSetParam.c
			SQLSetPos.c
			SQLSetScrollOptions.c
			SQLSetStmtAttr.c
			SQLSetStmtOption.c
			SQLSpecialColumns.c
			SQLStatistics.c
			SQLTablePrivileges.c
			SQLTables.c
			SQLTransact.c driver.rc ODBC.syms)
target_link_libraries(MonetODBC PUBLIC MonetODBC_headers PRIVATE mutils mapi stream ${ICONV_LIBRARIES} ${ODBCINST_LIBRARIES}
					  ${CRYPTO_LIBRARIES} ${SOCKET_LIBRARIES})
target_compile_definitions(MonetODBC PRIVATE LIBMONETODBC)
install(TARGETS MonetODBC DESTINATION ${LIBDIR})
if(WIN32)
	install(FILES $<TARGET_PDB_FILE:MonetODBC> DESTINATION ${LIBDIR} OPTIONAL)
endif()
